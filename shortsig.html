<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Short Signatures - Double-Odd Elliptic Curves</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="favicon.svg">
        
        
        <link rel="shortcut icon" href="favicon.png">
        
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        
        <link rel="stylesheet" href="css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="front.html"><strong aria-hidden="true">1.</strong> Double-Odd Elliptic Curves</a></li><li class="chapter-item expanded "><a href="intro.html"><strong aria-hidden="true">2.</strong> A Geometrical Introduction</a></li><li class="chapter-item expanded "><a href="jacobi.html"><strong aria-hidden="true">3.</strong> Double-Odd to Jacobi Quartics</a></li><li class="chapter-item expanded "><a href="shortsig.html" class="active"><strong aria-hidden="true">4.</strong> Short Signatures</a></li><li class="chapter-item expanded "><a href="formulas.html"><strong aria-hidden="true">5.</strong> Formulas</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="formulas-xy.html"><strong aria-hidden="true">5.1.</strong> Affine (x, y) Coordinates</a></li><li class="chapter-item expanded "><a href="formulas-xw.html"><strong aria-hidden="true">5.2.</strong> Affine and Jacobian (x, w) Coordinates</a></li><li class="chapter-item expanded "><a href="formulas-xu.html"><strong aria-hidden="true">5.3.</strong> Affine and fractional (x, u) Coordinates</a></li><li class="chapter-item expanded "><a href="formulas-ladder.html"><strong aria-hidden="true">5.4.</strong> x-only Ladders</a></li><li class="chapter-item expanded "><a href="formulas-eu.html"><strong aria-hidden="true">5.5.</strong> Affine and extended (e, u) Coordinates</a></li></ol></li><li class="chapter-item expanded "><a href="curves.html"><strong aria-hidden="true">6.</strong> Curve Choices</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="params-do255e.html"><strong aria-hidden="true">6.1.</strong> do255e / jq255e</a></li><li class="chapter-item expanded "><a href="params-do255s.html"><strong aria-hidden="true">6.2.</strong> do255s / jq255s</a></li></ol></li><li class="chapter-item expanded "><a href="benchmarks.html"><strong aria-hidden="true">7.</strong> Benchmarks</a></li><li class="chapter-item expanded "><a href="implementations.html"><strong aria-hidden="true">8.</strong> Implementations</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Double-Odd Elliptic Curves</h1>

                    <div class="right-buttons">
                        
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <style type="text/css">
    .coal img {
        background-color: #E0E0E0;
    }
    .navy img {
        background-color: #E0E0E0;
    }
    .ayu img {
        background-color: #E0E0E0;
    }
</style>
<h1><a class="header" href="#short-signatures" id="short-signatures">Short Signatures</a></h1>
<p>Since the Jacobi quartic \((e,u)\) coordinates come with an improved
decoding process that changes the on-the-wire encoding of group
elements, thereby breaking backward compatibility with the original
do255e and do255s, we take the opportunity to define an altered
signature scheme. That new scheme yields <strong>shorter signatures</strong> (48
bytes instead of 64), which is important for some applications (e.g. if
the signature must fit in some payload in a cramped QR code). As a nice
side-effect, the change also makes signature verification <em>faster</em>,
while not changing the performance of signature generation.</p>
<p>The idea is, in fact, quite old, and should be well-known, since it was
already proposed by Schnorr himself back in 1989, and also proposed
again several times (at least by <a href="https://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.58.659">Naccache and
Stern</a>
in 2001, and <a href="https://www.esat.kuleuven.be/cosic/publications/article-1167.pdf">Neven, Smart and
Warinschi</a>
in 2009). Weirdly enough, there is no standard that leverages it, even
though the benefits are non-negligible. It is applicable to any
Schnorr signature system, not only double-odd curves (but, of course,
double-odd curves work nicely with it, with their very good performance
and compact encoding).</p>
<p>A Schnorr signature scheme can be described as follows:</p>
<ul>
<li>
<p>The private key is a scalar \(d\). The corresponding public key
is \(Q = dG\), with \(G\) begin the conventional generator for
a prime order group of order \(r\).</p>
</li>
<li>
<p>To sign a message \(m\), a per-signature secret scalar \(k\)
is generated (uniformly among integers modulo \(r\)), then the
point \(R = kG\) is computed (this is the <em>commitment</em>). A
<em>challenge</em> value is then computed with a hash function \(H\)
as \(c = H(R \parallel Q \parallel m)\) (i.e. we hash the
commitment, the public key and the message together to get the
challenge). The challenge is interpreted as an integer, and the
<em>response</em> to that challenge is \(s = k + cd\). The signature
value is nominally the triplet \((R, c, s)\).</p>
</li>
<li>
<p>The verification of the signature entails checking that the
challenge \(c\) indeed matches \(H(R \parallel Q \parallel m)\),
and that the equation \(R = sG - cQ\) is fulfilled.</p>
</li>
</ul>
<p>Since <em>verifying</em> the challenge means <em>recomputing</em> it, that value does
not need to be transmitted, leading to a signature containing
exactly the pair \((R,s)\). This is exactly how such things are done
in the well-known <a href="https://www.rfc-editor.org/rfc/rfc8032">EdDSA</a>
scheme. In the case of Ed25519, \(R\) and \(s\) are encoded over
32 bytes each, for a total signature size of 64 bytes.</p>
<p>We can also choose to omit \(R\) instead of \(c\): given \(Q\),
\(s\) and \(c\), we can <em>recompute</em> \(R = sG - cQ\). This leads to
an alternate representation of the signature as the pair \((c,s)\).
From this, we can get a gain in size by noticing that \(c\) does not
actually <em>need</em> to be as large as the group. It can be shorter.</p>
<p>The <a href="https://www.esat.kuleuven.be/cosic/publications/article-1167.pdf">Neven-Smart-Warinschi
paper</a>
includes some detailed security analysis, which we can summarize as
follows:</p>
<ul>
<li>
<p>The security of Schnorr signatures does not depend upon the
collision resistance of the hash function \(H\).</p>
</li>
<li>
<p>There are known proofs of security that reduce the security of
Schnorr signatures to the discrete logarithm problem in the group
with some conditions on the size of the group and the size of the
output of \(H\). They show that if you target &quot;\(n\) bits of
security&quot;, then you will get them from a group of size \(2^{3n}\)
and a hash function output of \(2n\) bits (assuming ideal group
and hash function).</p>
</li>
<li>
<p>The proofs are not tight; they don't show that attacks are possible
up to these sizes. In fact, against the best known attacks, the
\(n\)-bit security level is obtained with a \(2^{2n}\) group
(e.g. a 256-bit elliptic curve) and a hash output of only \(n\)
bits.</p>
</li>
<li>
<p>We already disregard the proofs in practice. For instance, Ed25519
claims &quot;128-bit security&quot; with a 256-bit curve, while the proofs
would call for a 384-bit curve.</p>
</li>
</ul>
<p>From this analysis, we should get a <em>practical</em> security of 128 bits if
we use a 256-bits-or-so elliptic curve (e.g. jq255e or jq255s) and a
128-bit challenge \(c\). Combined with the \((c,s)\) representation
of signatures, this yields a total signature size of <strong>48 bytes</strong>.</p>
<p>In the fine details of the Neven-Smart-Warinschi analysis, we see that
the hash function must behave quite closely to an ideal hash function,
which rules out &quot;narrow-pipe&quot; designs; in plain words, we get our full
128-bit security only if the hash function \(H\) is really a good hash
function with a 256-bit output, that we then truncate to 128 bits. A
standard 256-bit hash function should work; we choose BLAKE2s (which is
secure but also quite fast and maps well to small 32-bit systems).
SHA-256, or even SHA3-256, would also work.</p>
<p>The <strong>speed advantage</strong> comes from the fact that the computation of
\(R = sG - cQ\) can be split into:
\[\begin{equation*}
R = (s \bmod 2^{128}) G + (\lfloor s/2^{128} \rfloor) (2^{128} G) + c (-Q)
\end{equation*}\]
i.e. a linear combination of <em>three</em> points (two of which being amenable
to precomputations) with half-size (128 bits) coefficients. This yields
better performance than the usual EdDSA signature verification, even if
using the Antipa <em>et al</em> optimization with <a href="https://eprint.iacr.org/2020/454">Lagrange's lattice basis
reduction</a>: the latter leads to a
linear combination of <em>four</em> points with half-size coefficients (and
adds the cost of Lagrange's algorithm, which we avoid here).</p>
<p>In total, we can get signature verification on jq255e and jq255s to run
in less than 100k cycles on an Intel x86 CPU (Coffee Lake core). The
main advantage of the short signatures is their reduced size, but the
speed gain is nice as well.</p>
<p>It shall be noted that the shorter signature format is not compatible
with batch verification. With EdDSA signatures, one can leverage the
presence of \(R\) in the signature to verify many signatures with a
lower per-signature cost; this optimization cannot be applied to the
shorter \((c,s\)) signature format. Of course, the point of batch
verification is to reduce the per-verification cost, and that is less
needed if the verification of a single signature is already fast.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="jacobi.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="formulas.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="jacobi.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="formulas.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
